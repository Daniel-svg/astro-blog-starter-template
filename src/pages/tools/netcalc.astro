---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';

const title = 'ç¶²æ®µè¨ˆç®—æ©Ÿ';
const description = 'ç¶²æ®µè¨ˆç®—æ©Ÿï¼Œæä¾›å¿«é€ŸæŸ¥è©¢å¯ç”¨IPä½å€ã€å­ç¶²é®ç½©èˆ‡å»£æ’­åœ°å€ã€‚';
---

<!doctype html>
<html lang="zh-Hant">
<head>
Â  Â  <!-- ğŸ’¡ BaseHead è² è²¬å¼•å…¥å…¨åŸŸ CSS (html, body, main æ¨£å¼) -->
Â  Â  <BaseHead title={title} description={description} />

Â  Â  <!-- Icons -->
Â  Â  <link
Â  Â  Â  rel="stylesheet"
Â  Â  Â  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
Â  Â  Â  crossorigin="anonymous"
Â  Â  />

Â  Â  <!-- Google Ads -->
Â  Â  <script
Â  Â  Â  async
Â  Â  Â  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6026639928482840"
Â  Â  Â  crossorigin="anonymous"
Â  Â  ></script>

Â  Â  <style>
Â  Â  Â  /* ğŸš€ é é¢å°ˆå±¬æ¨£å¼ï¼šåªé‡å°ç¶²æ®µè¨ˆç®—æ©Ÿå¡ç‰‡å’Œ UI å…ƒç´  */
Â  Â  Â  
Â  Â  Â  /* ===== å¡ç‰‡å®¹å™¨ ===== */
Â  Â  Â  .calculator-container {
Â  Â  Â  Â  background: #fff;
Â  Â  Â  Â  padding: 3rem;
Â  Â  Â  Â  border-radius: 18px;
Â  Â  Â  Â  border: 1px solid #efefef;
Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  /* è®“å¡ç‰‡åœ¨ main å®¹å™¨å…§å±…ä¸­ */
Â  Â  Â  Â  margin: 0 auto; 
        /* ç”±æ–¼ BaseHead æ‡‰å·²é™åˆ¶ main å¯¬åº¦ï¼Œæ­¤è™•å¯ä¸å¯« max-widthï¼Œ
           ä½†ç‚ºäº†ç¢ºä¿æ¨£å¼ç¨ç«‹æ€§ï¼Œå¯å¢åŠ ä¸€å€‹å¯¬åº¦æ§åˆ¶ */
        max-width: 800px;
Â  Â  Â  }

Â  Â  Â  @media (max-width: 500px) {
Â  Â  Â  Â  .calculator-container {
Â  Â  Â  Â  Â  padding: 1.6rem;
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  h1 {
Â  Â  Â  Â  font-size: 2.2rem;
Â  Â  Â  Â  color: #3c4043;
Â  Â  Â  Â  margin-bottom: 2rem;
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  gap: 12px;
Â  Â  Â  }

Â  Â  Â  h1 i {
Â  Â  Â  Â  color: #4285f4;
Â  Â  Â  }

Â  Â  Â  /* ===== è¼¸å…¥æ¬„ä½ ===== */
Â  Â  Â  .input-group {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  }

Â  Â  Â  @media (min-width: 768px) {
Â  Â  Â  Â  .input-group {
Â  Â  Â  Â  Â  flex-direction: row;
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  input[type="text"] {
Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  padding: 14px 18px;
Â  Â  Â  Â  border: 1px solid #dadce0;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  Â  font-family: 'Roboto Mono', monospace;
Â  Â  Â  Â  transition: 0.25s;
Â  Â  Â  }

Â  Â  Â  input[type="text"]:focus {
Â  Â  Â  Â  border-color: #4285f4;
Â  Â  Â  Â  box-shadow: 0 0 0 1px #4285f4;
Â  Â  Â  Â  outline: none;
Â  Â  Â  }

Â  Â  Â  /* æŒ‰éˆ• - è¨ˆç®— */
Â  Â  Â  button.calculate-btn {
Â  Â  Â  Â  padding: 14px 25px;
Â  Â  Â  Â  border: none;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  background: #4285f4;
Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  transition: 0.3s;
Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  }

Â  Â  Â  button.calculate-btn:hover {
Â  Â  Â  Â  background: #3367d6;
Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
Â  Â  Â  }

Â  Â  Â  /* äºŒé€²ä½åˆ‡æ›æŒ‰éˆ• */
Â  Â  Â  .toggle-bin {
Â  Â  Â  Â  display: inline-flex;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  background: #f1f3f4;
Â  Â  Â  Â  color: #5f6368;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  transition: 0.3s;
Â  Â  Â  Â  font-size: 0.95rem;
Â  Â  Â  }

Â  Â  Â  .toggle-bin:hover {
Â  Â  Â  Â  background: #e8eaed;
Â  Â  Â  Â  color: #202124;
Â  Â  Â  }

Â  Â  Â  .toggle-bin i {
Â  Â  Â  Â  margin-right: 8px;
Â  Â  Â  Â  color: #5f6368;
Â  Â  Â  }

Â  Â  Â  /* ===== çµæœå€å¡Š ===== */
Â  Â  Â  .results {
Â  Â  Â  Â  margin-top: 30px;
Â  Â  Â  Â  text-align: left;
Â  Â  Â  }

Â  Â  Â  .results > div {
Â  Â  Â  Â  padding: 12px 15px;
Â  Â  Â  Â  border-bottom: 1px solid #efefef;
Â  Â  Â  Â  background: #fcfcfc;
Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  gap: 4px;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  margin-bottom: 6px;
Â  Â  Â  }

Â  Â  Â  /* é‡è¦çµæœ */
Â  Â  Â  .primary-result {
Â  Â  Â  Â  background: #e8f0fe !important;
Â  Â  Â  Â  border-left: 5px solid #4285f4;
Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  }

Â  Â  Â  .results strong {
Â  Â  Â  Â  color: #3c4043;
Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  display: block;
Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  margin-bottom: 4px;
Â  Â  Â  }

Â  Â  Â  @media (min-width: 600px) {
Â  Â  Â  Â  .results strong {
Â  Â  Â  Â  Â  width: 220px;
Â  Â  Â  Â  Â  margin-bottom: 0;
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  .results span {
Â  Â  Â  Â  font-family: 'Roboto Mono', monospace;
Â  Â  Â  Â  word-break: break-word;
Â  Â  Â  Â  overflow-wrap: break-word;
Â  Â  Â  Â  font-size: 1rem;
Â  Â  Â  }

Â  Â  Â  .binary-val {
Â  Â  Â  Â  display: block;
Â  Â  Â  Â  margin-bottom: 2px;
Â  Â  Â  }

Â  Â  Â  .error-message {
Â  Â  Â  Â  color: #c00;
Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  padding: 15px;
Â  Â  Â  }
Â  Â  </style>
</head>

<body>
Â  Â  <Header />

Â  Â  <!-- ğŸ’¡ å‡è¨­ BaseHead è¼‰å…¥çš„å…¨å±€ CSS å·²ç‚º main æ¨™ç±¤è¨­ç½® max-width, margin: auto, å’Œ padding -->
Â  Â  <main>
Â  Â  Â  <div class="calculator-container">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <h1><i class="fas fa-network-wired"></i> ç¶²æ®µè¨ˆç®—æ©Ÿ</h1>

Â  Â  Â  Â  <!-- è¼¸å…¥æ¬„ä½ -->
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  <input type="text" id="cidrInput" placeholder="IP/å­ç¶² (ä¾‹: 192.168.1.10/24)">
Â  Â  Â  Â  Â  <input type="text" id="maskInput" placeholder="æˆ–å­ç¶²é®ç½© (ä¾‹: 255.255.255.0)">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="calculate-btn" onclick="calculate()">
Â  Â  Â  Â  Â  <i class="fas fa-calculator"></i> é–‹å§‹è¨ˆç®—
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <div class="toggle-bin" id="toggleBinaryButton" onclick="toggleBinary()">
Â  Â  Â  Â  Â  <i class="fas fa-exchange-alt"></i> åˆ‡æ›äºŒé€²ä½é¡¯ç¤º
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- çµæœå€ -->
Â  Â  Â  Â  <div class="results" id="results">
Â  Â  Â  Â  Â  <div style="text-align:center; border-bottom:none; background:transparent;">
Â  Â  Â  Â  Â  Â  <i class="fas fa-mouse-pointer"></i> è«‹è¼¸å…¥ IP åœ°å€é–‹å§‹è¨ˆç®—
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <Footer />

Â  Â  <!-- JS -->
Â  Â  <script is:inline>
Â  Â  Â  /* å°‡æ‰€æœ‰ IP ç›¸é—œçš„ helper å‡½æ•¸å®šç¾©åœ¨å‰é¢ */
Â  Â  Â  function ipToInt(ipArr){
Â  Â  Â  Â  return (ipArr[0]>>>0)*16777216 +
Â  Â  Â  Â  Â  Â  Â  Â (ipArr[1]>>>0)*65536 +
Â  Â  Â  Â  Â  Â  Â  Â (ipArr[2]>>>0)*256 +
Â  Â  Â  Â  Â  Â  Â  Â (ipArr[3]>>>0);
Â  Â  Â  }

Â  Â  Â  function intToIp(int){
Â  Â  Â  Â  return [
Â  Â  Â  Â  Â  (int>>>24)&255,
Â  Â  Â  Â  Â  (int>>>16)&255,
Â  Â  Â  Â  Â  (int>>>8)&255,
Â  Â  Â  Â  Â  int&255
Â  Â  Â  Â  ];
Â  Â  Â  }

Â  Â  Â  function ipToBinary(ip){
Â  Â  Â  Â  return ip.split('.')
Â  Â  Â  Â  Â  .map(n => parseInt(n).toString(2).padStart(8, "0"))
Â  Â  Â  Â  Â  .join('.');
Â  Â  Â  }

Â  Â  Â  function isPrivateIP(ip){
Â  Â  Â  Â  const [a,b] = ip.split('.').map(Number);
Â  Â  Â  Â  if(a===10) return "ç§æœ‰ç¶²æ®µ (A é¡)";
Â  Â  Â  Â  if(a===172 && b>=16 && b<=31) return "ç§æœ‰ç¶²æ®µ (B é¡)";
Â  Â  Â  Â  if(a===192 && b===168) return "ç§æœ‰ç¶²æ®µ (C é¡)";
Â  Â  Â  Â  if(a===127) return "è¿´åœˆæœ¬åœ° (Loopback)";
Â  Â  Â  Â  if(a>=224 && a<=239) return "å¤šæ’­åœ°å€ (Multicast)";
Â  Â  Â  Â  return "å…¬ç¶²IP";
Â  Â  Â  }

Â  Â  Â  let showBinary = false;

Â  Â  Â  function calculate(){
Â  Â  Â  Â  const cidrInput = document.getElementById('cidrInput').value.trim();
Â  Â  Â  Â  const maskValÂ  Â = document.getElementById('maskInput').value.trim();
Â  Â  Â  Â  const resultsÂ  Â = document.getElementById('results');

Â  Â  Â  Â  let ip, mask, prefix;

Â  Â  Â  Â  // åˆ¤æ–·è¼¸å…¥æ¨¡å¼ (CIDR æˆ– IP + Mask)
Â  Â  Â  Â  if(cidrInput.includes('/')){
Â  Â  Â  Â  Â  [ip, prefix] = cidrInput.split('/');
Â  Â  Â  Â  Â  prefix = parseInt(prefix);

Â  Â  Â  Â  Â  // è¨ˆç®—å­ç¶²é®ç½©
Â  Â  Â  Â  Â  mask = Array(4).fill(0).map((_,i)=>{
Â  Â  Â  Â  Â  Â  let rem = prefix - i*8;
Â  Â  Â  Â  Â  Â  if(rem>=8) return 255;
Â  Â  Â  Â  Â  Â  if(rem<=0) return 0;
Â  Â  Â  Â  Â  Â  return 256 - Math.pow(2, 8-rem);
Â  Â  Â  Â  Â  }).join('.');
Â  Â  Â  Â  }
Â  Â  Â  Â  else if(cidrInput && maskVal){
Â  Â  Â  Â  Â  ip = cidrInput;
Â  Â  Â  Â  Â  mask = maskVal;
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  // è¨ˆç®— CIDR
Â  Â  Â  Â  Â  prefix = mask.split('.')
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â .map(n => parseInt(n).toString(2).replace(/0/g,"").length)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â .reduce((a,b)=>a+b,0);
Â  Â  Â  Â  }
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  results.innerHTML =
Â  Â  Â  Â  Â  Â  `<div class="error-message"><i class="fas fa-exclamation-triangle"></i> è«‹è¼¸å…¥æœ‰æ•ˆ IP æˆ– CIDR</div>`;
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // åŸºç¤é©—è­‰
Â  Â  Â  Â  const ipPartsÂ  Â = ip.split('.').map(Number);
Â  Â  Â  Â  const maskParts = mask.split('.').map(Number);

Â  Â  Â  Â  if(ipParts.some(n=>isNaN(n)||n<0||n>255)
Â  Â  Â  Â  || maskParts.some(n=>isNaN(n)||n<0||n>255)
Â  Â  Â  Â  || prefix<0 || prefix>32){
Â  Â  Â  Â  Â  results.innerHTML =
Â  Â  Â  Â  Â  Â  `<div class="error-message"><i class="fas fa-exclamation-triangle"></i> è¼¸å…¥æ ¼å¼éŒ¯èª¤ (IP 0â€“255, CIDR 0â€“32)</div>`;
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // ç¶²è·¯è¨ˆç®—æ ¸å¿ƒé‚è¼¯
Â  Â  Â  Â  const networkÂ  Â = ipParts.map((n,i)=> n & maskParts[i]); // Network ID = IP AND Mask
Â  Â  Â  Â  const wildcardÂ  = maskParts.map(n => (~n & 255)); Â  Â  Â  Â  // Wildcard = NOT Mask
Â  Â  Â  Â  const broadcast = network.map((n,i)=> n | wildcard[i]); // Broadcast = Network OR Wildcard

Â  Â  Â  Â  const netInt = ipToInt(network);
Â  Â  Â  Â  const bcIntÂ  = ipToInt(broadcast);

Â  Â  Â  Â  // è¨ˆç®—ä¸»æ©Ÿç¯„åœ
Â  Â  Â  Â  let hostMinInt, hostMaxInt, hostCount = Math.pow(2, 32-prefix);

Â  Â  Â  Â  if(prefix === 32){
Â  Â  Â  Â  Â  hostMinInt = hostMaxInt = netInt;
Â  Â  Â  Â  Â  hostCount = 1;
Â  Â  Â  Â  } else if(prefix === 31){
Â  Â  Â  Â  Â  hostMinInt = netInt;
Â  Â  Â  Â  Â  hostMaxInt = bcInt;
Â  Â  Â  Â  Â  hostCount = 2;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  hostMinInt = netInt + 1;
Â  Â  Â  Â  Â  hostMaxInt = bcInt - 1;
Â  Â  Â  Â  Â  hostCount -= 2; // æ¸›å» Network ID å’Œ Broadcast
Â  Â  Â  Â  }

Â  Â  Â  Â  const hostMin = intToIp(hostMinInt);
Â  Â  Â  Â  const hostMax = intToIp(hostMaxInt);

Â  Â  Â  Â  // é¡¯ç¤ºè¼”åŠ©å‡½æ•¸ (è™•ç†äºŒé€²ä½åˆ‡æ›)
Â  Â  Â  Â  function display(arr){
Â  Â  Â  Â  Â  const str = arr.join('.');
Â  Â  Â  Â  Â  return showBinary
Â  Â  Â  Â  Â  Â  ? `<span class="binary-val">${ipToBinary(str)}</span><span>(${str})</span>`
Â  Â  Â  Â  Â  Â  : str;
Â  Â  Â  Â  }

Â  Â  Â  Â  function displayMask(m){
Â  Â  Â  Â  Â  return showBinary
Â  Â  Â  Â  Â  Â  ? `<span class="binary-val">${ipToBinary(m)}</span><span>(${m})</span>`
Â  Â  Â  Â  Â  Â  : m;
Â  Â  Â  Â  }

Â  Â  Â  Â  // æ¸²æŸ“çµæœ
Â  Â  Â  Â  results.innerHTML = `
Â  Â  Â  Â  Â  <div><strong><i class="fas fa-search"></i> è¼¸å…¥ IP:</strong><span>${display(ipParts)}</span></div>
Â  Â  Â  Â  Â  <div><strong><i class="fas fa-tag"></i> IP é¡å‹:</strong><span>${isPrivateIP(ip)}</span></div>
Â  Â  Â  Â  Â  <div><strong><i class="fas fa-divide"></i> å­ç¶²ä½å…ƒ (CIDR):</strong><span>/${prefix}</span></div>
Â  Â  Â  Â  Â  <div><strong><i class="fas fa-bars"></i> å­ç¶²é®ç½© (Mask):</strong><span>${displayMask(mask)}</span></div>
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  <div class="primary-result">
Â  Â  Â  Â  Â  Â  <strong><i class="fas fa-home"></i> ç¶²æ®µä½å€ (Network ID):</strong>
Â  Â  Â  Â  Â  Â  <span>${display(network)}</span>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="primary-result">
Â  Â  Â  Â  Â  Â  <strong><i class="fas fa-broadcast-tower"></i> å»£æ’­ä½å€ (Broadcast):</strong>
Â  Â  Â  Â  Â  Â  <span>${display(broadcast)}</span>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="primary-result">
Â  Â  Â  Â  Â  Â  <strong><i class="fas fa-arrows-alt-h"></i> å¯ç”¨ä¸»æ©Ÿç¯„åœ:</strong>
Â  Â  Â  Â  Â  Â  <span>${display(hostMin)} - ${display(hostMax)}</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  <div><strong><i class="fas fa-users"></i> å¯ç”¨ä¸»æ©Ÿæ•¸é‡:</strong><span>${hostCount}</span></div>
Â  Â  Â  Â  `;
Â  Â  Â  }

Â  Â  Â  function toggleBinary(){
Â  Â  Â  Â  showBinary = !showBinary;

Â  Â  Â  Â  document.getElementById('toggleBinaryButton').innerHTML =
Â  Â  Â  Â  Â  showBinary
Â  Â  Â  Â  Â  ? `<i class="fas fa-align-left"></i> åˆ‡æ›ç‚ºåé€²ä½é¡¯ç¤º`
Â  Â  Â  Â  Â  : `<i class="fas fa-exchange-alt"></i> åˆ‡æ›äºŒé€²ä½é¡¯ç¤º`;

Â  Â  Â  Â  // é‡æ–°è¨ˆç®—ä¸¦æ¸²æŸ“ï¼Œä»¥æ›´æ–°äºŒé€²ä½é¡¯ç¤º
Â  Â  Â  Â  // é¿å…åœ¨é é¢è¼‰å…¥æ™‚å‘¼å« calculateï¼Œé™¤éä½¿ç”¨è€…å·²ç¶“è¼¸å…¥äº†å€¼
Â  Â  Â  Â  if (document.getElementById('cidrInput').value.trim() || document.getElementById('maskInput').value.trim()) {
Â  Â  Â  Â  Â  calculate();
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  </script>
</body>
</html>